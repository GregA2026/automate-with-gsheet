name: etl_worflow

on:
  schedule:
    - cron: '5 17 * 2 4'
  workflow_dispatch:

jobs:
  etl:
    runs-on: ubuntu-latest
    env:
      SHEET_ID : ${{ secrets.SHEET_ID}}
      WORKSHEET : Sheet1
      GOOGLE_SA_KEY_JSON : ${{ secrets.GOOGLE_SHEET_JSON}}
      PG_USER : postgres
      PG_PASSWORD : ${{ secrets.PG_PASSWORD}}
      PG_HOST : ${{ secrets.PG_HOST}}
      PG_PORT : 5432
      PG_DB : ${{ secrets.PG_DB}}
      PG_TABLE : etl_workflow

steps:
  - name: Checkout repository
    uses: actions/checkout@v4

  - name: Setup Python
    uses: actions/setup-python@v5
    with:
      python-version: "3.11"

  - name: Install dependencies
    run: pip install -r requirements.txt

  - name: Run ETL
    run: python etl.py